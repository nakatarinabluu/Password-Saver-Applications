#include <jni.h>
#include <string>

// Obfuscated Secrets (XOR Key: 0x7F)
unsigned char api_key[] = { 0x1A, 0x47, 0x19, 0x4E, 0x1E, 0x4D, 0x1D, 0x4C, 0x1C, 0x4B, 0x1B, 0x4A, 0x1A, 0x49, 0x19, 0x48, 0x1E, 0x47, 0x1D, 0x46, 0x1C, 0x4F, 0x1B, 0x4E, 0x1A, 0x4D, 0x19, 0x4C, 0x1E, 0x4B, 0x1D, 0x4A, 0x1C, 0x49, 0x1B, 0x48, 0x1A, 0x47, 0x19, 0x46, 0x1E, 0x4F, 0x1D, 0x4E, 0x1C, 0x4D, 0x1B, 0x4C, 0x1A, 0x4B, 0x19, 0x4A, 0x1E, 0x49, 0x00 };
unsigned char hmac_secret[] = { 0x1C, 0x4E, 0x1B, 0x4D, 0x1A, 0x4C, 0x19, 0x4B, 0x18, 0x4A, 0x17, 0x49, 0x16, 0x48, 0x15, 0x47, 0x14, 0x46, 0x13, 0x4F, 0x12, 0x4E, 0x11, 0x4D, 0x10, 0x4C, 0x0F, 0x4B, 0x0E, 0x4A, 0x0D, 0x49, 0x0C, 0x48, 0x0B, 0x47, 0x0A, 0x46, 0x09, 0x4F, 0x08, 0x4E, 0x07, 0x4D, 0x06, 0x4C, 0x05, 0x4B, 0x1E, 0x4A, 0x1D, 0x49, 0x1C, 0x48, 0x00 };
unsigned char base_url[] = { 0x17, 0x0B, 0x0B, 0x0F, 0x0C, 0x45, 0x50, 0x50, 0x05, 0x1A, 0x0D, 0x10, 0x14, 0x1A, 0x1A, 0x0F, 0x51, 0x09, 0x1A, 0x0D, 0x1C, 0x1A, 0x13, 0x51, 0x1E, 0x0F, 0x0F, 0x50, 0x00 };

std::string decrypt(unsigned char* encrypted, int size) {
    std::string decrypted = "";
    char key = 0x7F;
    // Iterate up to size-1 because the last byte is the explicit 0x00 terminator from python
    for (int i = 0; i < size - 1; i++) {
        decrypted += (char)(encrypted[i] ^ key);
    }
    return decrypted;
}

extern "C" JNIEXPORT jstring JNICALL
Java_com_vaultguard_app_di_NetworkModule_getApiKey(
        JNIEnv* env,
        jobject /* this */) {
    return env->NewStringUTF(decrypt(api_key, sizeof(api_key)).c_str());
}

extern "C" JNIEXPORT jstring JNICALL
Java_com_vaultguard_app_di_NetworkModule_getHmacSecret(
        JNIEnv* env,
        jobject /* this */) {
    return env->NewStringUTF(decrypt(hmac_secret, sizeof(hmac_secret)).c_str());
}

extern "C" JNIEXPORT jstring JNICALL
Java_com_vaultguard_app_di_NetworkModule_getBaseUrl(
        JNIEnv* env,
        jobject /* this */) {
    return env->NewStringUTF(decrypt(base_url, sizeof(base_url)).c_str());
}
